import argparse

from src.exploit.payload import payload, exploit


def run_cli():
	parser = argparse.ArgumentParser(prog="Pickle Exploit", description="Pickle module vulnerability.")
	parser.add_argument("-pd", "--payload", action="store_true", help="Create payload")
	parser.add_argument("-i", "--ip", help="Target IP")
	parser.add_argument("-p", "--port", help="Target PORT")
	args = parser.parse_args()

	return payload() if args.payload else exploit(ip=args.ip, port=args.port)


if __name__ == "__main__":
	run_cli()
